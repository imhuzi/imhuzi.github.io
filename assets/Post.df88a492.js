import{H as E,Y as H,_ as $,d as N,G as q,a as D,h as v,l as R,m as z,n as A,o as l,c,w as m,e as P,b as V,k as O,v as Y,g as t,s as L,x as S,q as j,T as G,W as M,Q}from"./app.1b8ecc2b.js";import{A as U,P as I}from"./Page.56849ec5.js";import{u as J,C as K}from"./Common.cb85b6b0.js";import{P as X}from"./Pager.0727f0b0.js";import{u as Z}from"./useBlog.4a8520e3.js";import"./resolveTime.439cd54d.js";const x=({headers:k,activeLink:r})=>{const n=E();return H("ul",{class:{catalog:!0}},k.map(a=>H("li",{class:{active:r===a.slug,[`level-${a.level}`]:!0,[`toc-link-${a.slug}`]:!0},key:a.title,onClick:()=>{n.currentRoute.value.hash!==`#${a.slug}`&&n.push(`#${a.slug}`)}},a.title)))};x.displayName="Catalog";x.props={headers:{type:Object,required:!0},activeLink:{type:String,default:""}};const ee=N({setup(k){const r=M();q();const n=D(),a=E(),T=Q(),b=T.resolve,F=T.pending,i=J(),W=v(()=>i.value?r.value.headers:[]),w=o=>o.children.length>0?[o].concat(...o.children.map(w)):o,u=v(()=>[].concat(...W.value.map(w))),e=R({headerHeight:0,screenWidth:0,catalogTop:0,activeLink:"",isFixed:!1}),p=40,y=80,d=()=>{for(let s=u.value.length-1;s>=0;s--){const C=u.value[s].slug,B=document.querySelector(`#${C}`);if((B?B.getBoundingClientRect().top:0)<=100){e.activeLink=C;break}}window.pageYOffset>e.headerHeight+p-y?(e.isFixed=!0,e.catalogTop=y):(e.isFixed=!1,e.catalogTop=e.headerHeight+p),e.screenWidth<=719&&(e.catalogTop=-15)},g=()=>{const o=document.querySelector(".post-header");e.headerHeight=o?o.offsetHeight:0,e.screenWidth=document.body.clientWidth,e.screenWidth<=719?e.catalogTop=-15:e.catalogTop=e.headerHeight+p};let _;z(()=>{window.addEventListener("scroll",d),g(),window.onresize=()=>(()=>{g(),d()})(),_=a.afterEach(()=>{g()})}),A(()=>{window.removeEventListener("scroll",d),_()});const{post:h}=Z(),f=v(()=>{if(!h.value)return{};const o=h.value.next;o&&(o.text=n.value.postNext);const s=h.value.prev;return s&&(s.text=n.value.postPrev),{next:o,prev:s}});return(o,s)=>(l(),c(K,null,{page:m(()=>[P(G,{name:"fade-slide-y",mode:"out-in",onBeforeEnter:t(b),onBeforeLeave:t(F)},{default:m(()=>[V("div",{class:S(["post-wrapper",{"show-catalog":t(i)}])},[O(P(U,{class:"post-header"},null,512),[[Y,t(r).title]]),(l(),c(I,{key:t(r).path,class:"post-content"},{bottom:m(()=>[t(f).next||t(f).prev?(l(),c(X,{key:0,data:t(f)},null,8,["data"])):L("",!0)]),_:1})),t(i)?(l(),c(t(x),{key:0,headers:t(u),"active-link":t(e).activeLink,class:S({fixed:t(e).isFixed}),style:j({top:`${t(e).catalogTop}px`})},null,8,["headers","active-link","class","style"])):L("",!0)],2)]),_:1},8,["onBeforeEnter","onBeforeLeave"])]),_:1}))}});var ce=$(ee,[["__file","Post.vue"]]);export{ce as default};
